{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Normalized Security Alert Schema",
  "description": "Unified alert format for SOC triage, compatible with multiple sources",
  "type": "object",
  "required": ["alert_id", "severity", "source", "title", "description", "timestamp"],
  "properties": {
    "alert_id": {
      "type": "string",
      "description": "Unique identifier for this alert"
    },
    "severity": {
      "type": "string",
      "enum": ["LOW", "MEDIUM", "HIGH", "CRITICAL"],
      "description": "Alert severity classification"
    },
    "source": {
      "type": "string",
      "description": "Source system that generated the alert",
      "examples": ["crowdstrike", "splunk", "sentinel", "suricata", "wazuh"]
    },
    "title": {
      "type": "string",
      "description": "Brief alert title"
    },
    "description": {
      "type": "string",
      "description": "Detailed alert description"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of alert generation"
    },
    "affected_user": {
      "type": "string",
      "description": "Username or email of affected user"
    },
    "affected_host": {
      "type": "string",
      "description": "Hostname or IP address of affected system"
    },
    "raw_data": {
      "type": "object",
      "description": "Original alert payload from source system"
    }
  },
  "examples": [
    {
      "alert_id": "CRS-2024-0001",
      "severity": "HIGH",
      "source": "crowdstrike",
      "title": "Suspicious PowerShell Execution",
      "description": "Detection of base64-encoded PowerShell command with network activity",
      "timestamp": "2024-01-27T03:45:00Z",
      "affected_user": "john.doe",
      "affected_host": "DESKTOP-ABC123",
      "raw_data": {
        "detection_id": "ldt:12345",
        "tactics": ["execution", "command_and_control"],
        "techniques": ["T1059.001", "T1071.001"]
      }
    },
    {
      "alert_id": "SPL-2024-0042",
      "severity": "MEDIUM",
      "source": "splunk",
      "title": "Multiple Failed Login Attempts",
      "description": "15 failed SSH login attempts from 192.168.1.100 in 5 minutes",
      "timestamp": "2024-01-27T04:12:00Z",
      "affected_host": "webserver-01",
      "raw_data": {
        "source_ip": "192.168.1.100",
        "failed_count": 15,
        "time_window": "5m"
      }
    }
  ]
}
